(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,n,r){return(n=function(e){var n=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===t(n)?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}e.d({},{i8:()=>x,jL:()=>y,wi:()=>L,FH:()=>_,OP:()=>J,iW:()=>R,EG:()=>S,ER:()=>H,Ft:()=>C,gD:()=>j,NT:()=>D,HK:()=>B,RU:()=>N,JO:()=>T,x$:()=>g,Jx:()=>U,Kg:()=>q,LT:()=>I,BU:()=>K,rC:()=>F});var i=function(e){return fetch(_+"cards/"+e,{method:"DELETE",headers:y})},c=function(e){return fetch(_+"cards/likes/".concat(e),{method:"PUT",headers:y})},u=function(e){return fetch(_+"cards/likes/".concat(e),{method:"DELETE",headers:y})};function a(e){e.classList.add("popup_opened")}function l(e){e.classList.remove("popup_opened")}var s=function(e,t){var n=e.querySelector(".".concat(t.id,"-input-error"));t.classList.remove(R.inputErrorClass),n.classList.remove(R.errorClass),n.textContent=""};function p(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):(t.classList.add(n.inactiveButtonClass),t.disabled=!0)}function d(e){if(e.target.classList.contains("element__trash-button")){var t=e.target.closest(".element");i(t.id).then((function(e){return e.ok?e.json():Promise.reject(e.statusText)})).then((function(){t.remove()})).catch((function(e){return console.log("Ошибка: ".concat(e))}))}}function f(e){var t=e.target,n=e.target.closest(".element"),r=n.querySelector(".element__like-number");t.classList.contains("element__button_active")?u(n.id).then((function(e){return e.ok?e.json():Promise.reject(e.statusText)})).then((function(e){r.textContent=e.likes.length,t.classList.remove("element__button_active")})).catch((function(e){console.log(e)})):c(n.id).then((function(e){return e.ok?e.json():Promise.reject(e.statusText)})).then((function(e){r.textContent=e.likes.length,t.classList.add("element__button_active")})).catch((function(e){console.log(e)}))}function m(e){var t=e.name,n=e.link,r=e.likes,o=e.cardId,i=e.owner,c=e.isLiked,u=J.content.cloneNode(!0).querySelector(".element"),l=u.querySelector(".element__title"),s=u.querySelector(".element__image"),p=u.querySelector(".element__button"),m=u.querySelector(".element__trash-button"),_=u.querySelector(".element__like-number");return u.id=o,l.textContent=t,s.src=n,s.alt=t,_.textContent=r,i?m.addEventListener("click",d):m.remove(),c&&p.classList.add("element__button_active"),p.addEventListener("click",f),s.addEventListener("click",(function(e){e.stopPropagation(),function(e){var t=e.querySelector(".element__title").textContent,n=e.querySelector(".element__image").src;B.src=n,B.alt=t,N.textContent=t,a(D)}(u)})),u}var _="https://nomoreparties.co/v1/apf-cohort-202/",y={authorization:"7a6d984f-ee47-48a3-8ee3-bb2675ba62c9"},v=document.querySelector(".page"),b=v.querySelector(".profile__edit-button"),S=v.querySelector("#edit"),h=S.querySelector(".popup__close-button"),q=v.querySelector("#popupName"),g=v.querySelector("#popupDescription"),k=S.querySelector(".popup__form"),L=document.querySelector(".profile__avatar"),E=document.querySelector(".profile__avatar-wrapper");console.log(E,L);var C=v.querySelector("#avatar"),j=(C.querySelector(".popup__form"),C.querySelector("#popupAvatarLink")),O=C.querySelector(".popup__close-button"),P=v.querySelector(".profile__add-button"),x=v.querySelector("#add"),w=x.querySelector(".popup__close-button"),T=x.querySelector(".popup__form"),D=v.querySelector("#photo"),A=D.querySelector(".popup__close-button"),B=D.querySelector(".popup__image"),N=D.querySelector(".popup__image-text"),J=document.querySelector("#card-template"),H=document.querySelector(".elements__list"),I=document.querySelector("#popupTitle"),U=document.querySelector("#popupImageLink"),F=v.querySelector(".profile__name"),K=v.querySelector(".profile__description"),M=(v.querySelector(".profile__avatar"),""),R={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit",inactiveButtonClass:"popup__submit_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"};fetch(_+"users/me",{headers:y}).then((function(e){return e.json()})).then((function(e){F.textContent=e.name,K.textContent=e.about,M=e._id,L.src=e.avatar})),fetch(_+"cards",{headers:y}).then((function(e){return e.json()})).then((function(e){e.forEach((function(e){var t=e.likes.some((function(e){return e._id===M})),n=m({name:e.name,link:e.link,likes:e.likes.length,cardId:e._id,owner:e.owner._id===M,isLiked:t});H.appendChild(n)}))})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);p(n,r,t),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){var r=t.dataset.errorText,o=t.validity.valid;t.setCustomValidity(t.validity.patternMismatch?r:""),o?s(e,t):function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-input-error"));t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass)}(e,t,t.validationMessage,n)}(e,o,t),p(n,r,t)}))}))}(t,e)}))}(R),b.addEventListener("click",(function(e){e.stopPropagation(),q.value=F.textContent,g.value=K.textContent,a(S)})),P.addEventListener("click",(function(e){e.stopPropagation(),a(x)})),E.addEventListener("click",(function(e){e.stopPropagation(),j.value="",a(C)})),h.addEventListener("click",(function(){return l(S)})),w.addEventListener("click",(function(){return l(x)})),A.addEventListener("click",(function(){return l(D)})),O.addEventListener("click",(function(){return l(C)})),k.addEventListener("submit",(function(e){e.preventDefault(),console.log("save"),S.querySelector(".popup__submit").value="Сохранение...",fetch(_+"users/me",{method:"PATCH",headers:r(r({},y),{},{"Content-Type":"application/json"}),body:JSON.stringify({name:q.value,about:g.value})}).then((function(e){return e.json()})).then((function(e){F.textContent=e.name,K.textContent=e.about})).finally((function(){l(S),S.querySelector(".popup__submit").value="Сохранить"}))})),T.addEventListener("submit",(function(e){var t,n;e.preventDefault(),x.querySelector(".popup__submit").value="Сохранение...",(t=I.value,n=U.value,fetch(_+"cards",{method:"POST",headers:r(r({},y),{},{"Content-Type":"application/json"}),body:JSON.stringify({name:t,link:n})})).then((function(e){return e.json()})).then((function(e){var t=m({name:e.name,link:e.link,likes:0,cardId:e.id,owner:!0});H.insertBefore(t,H.firstChild)})).finally((function(){l(x),T.reset(),x.querySelector(".popup__submit").value="Сохранить"}))})),C.addEventListener("submit",(function(e){e.preventDefault(),C.querySelector(".popup__submit").value="Сохранение...",fetch(_+"users/me/avatar",{method:"PATCH",headers:r(r({},y),{},{"Content-Type":"application/json"}),body:JSON.stringify({avatar:j.value})}).then((function(e){return e.json()})).then((function(e){L.src=e.avatar})).finally((function(){l(C),C.querySelector(".popup__submit").value="Сохранить"}))})),document.addEventListener("keydown",(function(e){var t=document.querySelector(".popup_opened");"Escape"===e.key&&l(t)})),document.addEventListener("click",(function(e){var t=document.querySelector(".popup_opened");!t||e.target.closest(".popup__container")||e.target.closest(".popup__image-container")||l(t)}))})();